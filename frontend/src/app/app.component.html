<div class="app-container" *ngIf="authService.user$ | async as user; else loginView">
  <!-- Mobile Menu Toggle -->
  <button class="mobile-menu-toggle" (click)="toggleMobileMenu()" aria-label="Toggle menu">
    <span class="hamburger" [class.open]="mobileMenuOpen"></span>
  </button>

  <!-- Mobile Overlay -->
  <div class="mobile-overlay" [class.active]="mobileMenuOpen" (click)="closeMobileMenu()"></div>

  <nav class="sidebar" [class.mobile-open]="mobileMenuOpen" [class.collapsed]="sidebarCollapsed">
    <div class="logo">
      <h1>ğŸ  Family Hub</h1>
      <button class="sidebar-toggle" (click)="toggleSidebar()" aria-label="Toggle sidebar">
        {{ sidebarCollapsed ? 'â€º' : 'â€¹' }}
      </button>
    </div>
    
    <div class="user-section">
      <div class="user-profile">
        <img [src]="user.picture" alt="Profile" class="user-avatar" />
        <div class="user-details">
          <p class="user-name">{{ user.name }}</p>
          <p class="user-email">{{ user.email }}</p>
        </div>
      </div>
      
      <div class="user-controls">
        <button class="pin-toggle" (click)="pinUnlocked ? lockPin() : unlockPin()" [disabled]="pinUnlocking" title="Toggle admin lock">
          <span class="pin-icon">{{ pinUnlocked ? 'ğŸ”“' : 'ğŸ”’' }}</span>
          <span class="pin-label">{{ pinUnlocked ? 'Unlocked' : 'Locked' }}</span>
        </button>
        
        <button class="logout-btn" (click)="authService.logout()" title="Logout">
          <span>ğŸšª</span>
          <span class="logout-label">Logout</span>
        </button>
      </div>
    </div>

    <ul class="nav-menu">
      <li *ngFor="let item of navItems" [class.hidden]="!isFeatureEnabled(item.key)">
        <a
          [routerLink]="item.route"
          routerLinkActive="active"
          (click)="closeMobileMenu()"
          [attr.title]="sidebarCollapsed ? item.label : null">
          <span class="icon">{{ item.icon }}</span>
          <span class="label">{{ item.label }}</span>
        </a>
      </li>
    </ul>
  </nav>

  <main class="main-content">
    <router-outlet></router-outlet>
  </main>
</div>

<ng-template #loginView>
  <router-outlet></router-outlet>
</ng-template>
